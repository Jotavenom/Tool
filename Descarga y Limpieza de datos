# --- 1. INSTALACI√ìN DE HERRAMIENTAS DE BIOINFORM√ÅTICA ---
print("‚öôÔ∏è Instalando Bioinform√°tica Stack (SRA-Toolkit, FastQC, Trimmomatic)...")
!apt-get update -qq
!apt-get install -y sra-toolkit fastqc trimmomatic -qq
!pip install biopython -q
print("‚úÖ Instalaci√≥n completada.\n")

# --- 2. OBTENCI√ìN DE LA REFERENCIA (BAIT) ---
import os
from Bio import Entrez, SeqIO

# Configura tu email para NCBI (Requisito √©tico)
Entrez.email = "bioinfo_consultor@proyecto.com" 

# Directorios de trabajo
DIRS = {
    "ref": "/content/referencias",
    "raw": "/content/raw_data",
    "clean": "/content/clean_data",
    "qc": "/content/qc_reports"
}
for d in DIRS.values(): os.makedirs(d, exist_ok=True)

# Descarga de la referencia (Jararhagina - B. jararaca)
BAIT_ID = "AF056025.1"
bait_path = os.path.join(DIRS["ref"], "bait_jararhagin.fasta")

print(f"üé£ Descargando secuencia referencia (Bait): {BAIT_ID}...")
try:
    with Entrez.efetch(db="nucleotide", id=BAIT_ID, rettype="fasta", retmode="text") as handle:
        record = SeqIO.read(handle, "fasta")
        SeqIO.write(record, bait_path, "fasta")
    print(f"‚úÖ Referencia guardada en: {bait_path}")
    print(f"   Longitud: {len(record.seq)} pb | Header: {record.description}")
except Exception as e:
    print(f"‚ùå Error descargando referencia: {e}")
